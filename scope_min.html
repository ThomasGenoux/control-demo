<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Scope MIN • chiffres en direct</title>
<style>
  body{background:#0b0f16;color:#e9eef6;font-family:system-ui,Segoe UI,Roboto,Arial;margin:0;padding:24px}
  .grid{display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:12px}
  .card{background:#10141f;border:1px solid #1c2434;border-radius:14px;padding:16px;text-align:center}
  .lbl{color:#96a0b5;margin-bottom:6px}
  .val{font-size:42px;font-weight:800}
  @media (max-width:900px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
</style>
</head>
<body>
  <h3>Scope MIN — lecture live de <code>/control</code></h3>
  <div id="status" class="lbl">Init...</div>
  <div class="grid">
    <div class="card"><div class="lbl">HR</div><div id="hr" class="val">—</div></div>
    <div class="card"><div class="lbl">SpO₂</div><div id="spo2" class="val">—</div></div>
    <div class="card"><div class="lbl">FR</div><div id="rr" class="val">—</div></div>
    <div class="card"><div class="lbl">TA</div><div id="bp" class="val">—</div></div>
    <div class="card"><div class="lbl">Temp</div><div id="temp" class="val">—</div></div>
  </div>

<script type="module">
const firebaseConfig = {
  apiKey: "AIzaSyBNix7CGySLt3ztIp3h4GyUfi1YGTuIbvA",
  authDomain: "control-panel-demo-59d4a.firebaseapp.com",
  databaseURL: "https://control-panel-demo-59d4a-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "control-panel-demo-59d4a",
  storageBucket: "control-panel-demo-59d4a.firebasestorage.app",
  messagingSenderId: "1083381420391",
  appId: "1:1083381420391:web:0d042a134004655a40dfc2",
  measurementId: "G-CKXT2SWQVW"
};

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const el = (id)=>document.getElementById(id);
const statusEl = el('status');

function apply(v = {}){
  el('hr').textContent   = (typeof v.hr==='number') ? Math.round(v.hr) : '—';
  el('spo2').textContent = (typeof v.spo2==='number') ? Math.round(v.spo2) : '—';
  el('rr').textContent   = (typeof v.rr==='number') ? Math.round(v.rr) : '—';
  el('bp').textContent   = (typeof v.bpSys==='number' && typeof v.bpDia==='number') ? (v.bpSys+' / '+v.bpDia) : '—';
  el('temp').textContent = (typeof v.temp==='number') ? v.temp.toFixed(1) : '—';
}

onValue(ref(db,'control'), (snap)=>{ apply(snap.val()); statusEl.textContent='✅ lecture en temps réel OK'; },
  (e)=>{ statusEl.textContent='❌ '+(e.code||e.message); });
</script>
</body>
</html>
